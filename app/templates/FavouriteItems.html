{% extends "Navbar.html" %}
{% block content %}
<div class="container mt-4">
    <h2>Team Fortress 2 Items Favourites</h2><br>
    <table class="table">
        <thead>
            <tr>
                <th>Image</th>
                <th>Name</th>
                <th>Class</th>
                <th>Type</th>
                <th>Quality</th>
                <th>Craftable</th>
            </tr>
        </thead>
        <tbody id="table-body">
        </tbody>
    </table>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.min.js"></script>

<script>
    const userId = localStorage.getItem('userID');

    function fetchData() {
        fetch(`http://127.0.0.1:5000/item/favourites/${userId}`)
            .then(response => {
                return response.json();
            })
            .then(data => {
                const tableBody = document.getElementById('table-body');
                tableBody.innerHTML = '';

                if (data.length === 0) {
                    const row = `
                        <tr class="align-middle">
                            <td colspan="7">
                                <span class="text-muted">No Favourite Items</span>
                            </td>
                        </tr>
                    `;
                    tableBody.innerHTML = row;
                } else {
                    data.forEach(item => {
                        const row = `
                            <tr class="align-middle">
                                <td hidden>${item._id}</td>
                                <td><img width = '50px' height = '50px' src="${item.image}"></td>
                                <td>${item.name}</td>
                                <td>${item.class}</td>
                                <td>${item.type}</td>
                                <td>${item.quality}</td>
                                <td>${item.craftable}</td>
                            </tr>
                        `;
                        tableBody.innerHTML += row;
                    });
                }
        });
    }

    fetchData()
</script>
{% endblock %}